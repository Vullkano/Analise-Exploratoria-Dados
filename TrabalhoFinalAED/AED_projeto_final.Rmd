---
title: |
  ![](ISCTE.png)
  Fatores que influenciam o consumo
author: 
  - Diogo Alexandre Alonso de Freitas, NÂº104841
  - Eliane Susso Efraim Gabriel, NÂº103303
  - JoÃ£o Francisco Marques GonÃ§alves da Silva Botas, NÂº104782
  - Maria JoÃ£o Ferreira LourenÃ§o, NÂº104716
  - Pedro BrÃ­gido Machado, NÂº98601
  - Umeima Adam Mahomed, NÂº99239
date: '31-03-2022'
output: html_document
---

```{r include=FALSE}
library(openxlsx)
library(tidyverse)
library(descr)
library(flextable)
library(moments)
library(paletteer)
library(RColorBrewer)
library(unikn)
library(ggplot2)
library(jmv)
```

## SumÃ¡rio Executivo

O presente documento traduz a anÃ¡lise de uma base de dados retirada de um questionÃ¡rio denominado ğ˜—ğ˜¦ğ˜³ğ˜§ğ˜ªğ˜­ ğ˜¥ğ˜¦ ğ˜Šğ˜°ğ˜¯ğ˜´ğ˜¶ğ˜®ğ˜° ğ˜¦ ğ˜Šğ˜°ğ˜®ğ˜±ğ˜°ğ˜³ğ˜µğ˜¢ğ˜®ğ˜¦ğ˜¯ğ˜µğ˜° ğ˜¥ğ˜¦ ğ˜Šğ˜°ğ˜®ğ˜±ğ˜³ğ˜¢. Neste documento sÃ£o abordadas questÃµes relacionadas com os fatores que influenciam a tomada de decisÃ£o dos jovens no momento da compra, sendo que os mesmos conduziram o estudo em causa. Para realizar esta pesquisa foram utilizadas diversas plataformas como o R, o Jamovi e o Excel.  

## IntroduÃ§Ã£o

O objetivo da exploraÃ§Ã£o da base de dados foi perceber qual a relevÃ¢ncia de um leque de fatores na tomada de decisÃ£o da compra de diferentes produtos por parte dos jovens, pelo que fomos investigar se o preÃ§o, a imagem do produto, a localizaÃ§Ã£o da loja e outros fatores influenciavam a forma de consumo dos jovens. Com este propÃ³sito partimos para a investigaÃ§Ã£o das variÃ¡veis que poderiam estar relacionadas com o nosso objetivo, estudando-as a nÃ­vel individual e a nÃ­vel relacional.

```{r, include=FALSE}

## Pergunta 1 ImportaÃ§Ã£o do ficheiro Excel e tratamento dos dados

#Com o propÃ³sito de analisar a base de dados utilizando a plataforma de anÃ¡lise estatÃ­stica R, importamos o ficheiro ğ˜Šğ˜—12_ğ˜‘ğ˜°ğ˜·ğ˜¦ğ˜¯ğ˜´_-_ğ˜Šğ˜°ğ˜±ğ˜ªğ˜¢_2 do Excel, que consiste na base de dados original com os dados tratados e preparados para que seja possÃ­vel a anÃ¡lise dos mesmos e a consequente tirada de conclusÃµes.

#Em seguida Ã© possÃ­vel observar as diferentes variÃ¡veis do nosso estudo, sendo que algumas estÃ£o organizadas de acordo com a escala de Likert, pelo que tÃªm um cÃ³digo de 1 a 5 ou de nada importante atÃ© extremamente importante.


bd <-read.xlsx("CP12_Jovens_-_Copia_2.xlsx")
colnames(bd)

## Pergunta 2 MudanÃ§a do nome de duas variÃ¡veis

#Para facilitar o estudo das variÃ¡veis inicialmente denominadas de "PaÃ­s" (ğ˜¤ğ˜°ğ˜¶ğ˜¯ğ˜µğ˜³ğ˜º) e de "agregado" (ğ˜¢ğ˜¨ğ˜³ğ˜¦ğ˜¨ğ˜¢ğ˜¥ğ˜°), procedemos Ã  alteraÃ§Ã£o da sua denominaÃ§Ã£o para "PaÃ­s_origem" e "Agregado_familiar", respetivamente.


names(bd)[2] <- c("PaÃ­s_origem")
names(bd)[6] <- c("Agregado_Familiar")

names(bd)[2]
names(bd)[6]

```

## Perfil dos Jovens

Antes de comeÃ§armos a analisar as variÃ¡veis Ã© necessÃ¡rio conhecer o perfil dos inquiridos e, para isso, iremos analisar alguns dados sobre os mesmos.

A amostra Ã© composta por 1575 indivÃ­duos portugueses e espanhÃ³is dos 18 aos 25 anos. No grÃ¡fico 1 Ã© possivel verificar a existÃªncia de um maior nÃºmero de inquiridos com 21 anos.

```{r,echo=FALSE, fig.align='center'}
tab_idade<-table(bd$Idade)
barplot(tab_idade,ylim=c(0,500),col=heat.colors(8), main = "Idade dos inquiridos")
```
*GrÃ¡fico 1 - GrÃ¡fico de barras sobre a idade dos inquiridos*

Ao observar a tabela 1 percebemos que a mÃ©dia das idades Ã© 21.2. Ao examinar o desvio padrÃ£o Ã© possÃ­vel verificar que este tem o valor de 1.8, um valor razoÃ¡vel, o que  demonstra que a mÃ©dia Ã© um valor fidedigno e com pouca discrepÃ¢ncia com os valores reais(isto acontece, pois existe cada vez menos inquiridos quanto mais se afastam da idade mediana que Ã© 21).
AlÃ©m disso, 25% dos jovens tÃªm entre 18 e 20 anos e 75% dos mesmos tÃªm entre 18 e 22 anos.

```{r, echo=FALSE, fig.align='center'}
# - - idade dados - - - 

bd$Idade[bd$Idade==99] <- NA

n_idade <- length(bd$Idade)
media_idade <- round(mean(bd$Idade,na.rm=TRUE),1)
mediana_idade <- median(bd$Idade,na.rm=TRUE)
desvpadr_idade <- round(sd(bd$Idade, na.rm=TRUE),1)
varianc_idade <- round(var(bd$Idade, na.rm=TRUE),1)
minimo_idade <- min(bd$Idade, na.rm=TRUE)
maximo_idade <- max(bd$Idade, na.rm=TRUE)
firstqt_idade <- round(quantile(bd$Idade, 0.25, na.rm=TRUE),1)
thirdqt_idade <- round(quantile(bd$Idade, 0.75, na.rm=TRUE), 1)
assimetria_idade <- round(skewness(bd$Idade, na.rm=TRUE),1)
curtose_idade <- round(kurtosis(bd$Idade, na.rm=TRUE),1)

# construÃ§Ã£o da tabela

Valor_idade <- c(n_idade, media_idade,mediana_idade,  desvpadr_idade, varianc_idade, minimo_idade, maximo_idade, firstqt_idade, thirdqt_idade, assimetria_idade, curtose_idade)
Medidas_idade <- c("N", "MÃ©dia", "Mediana", "Desvio padrÃ£o", "VariÃ¢ncia", "MÃ­nimo", "MÃ¡ximo", "1ÂºQuartil", "3ÂºQuartil", "Assimetria", "Curtose")
table_agreg_idade_idade <- data.frame(Medidas_idade,Valor_idade)
ftab_agreg_idade <- flextable(table_agreg_idade_idade)

#cor no fundo do cabeÃ§alho - bg
#cÃ³digo de cores
ftab_agreg_idade <- bg(ftab_agreg_idade, bg = "#3895D3", part = "header")

#cor da letra do cabeÃ§alho em branco
ftab_agreg_idade <- color(ftab_agreg_idade, color = "white", part = "header")
ftab_agreg_idade <- autofit(ftab_agreg_idade)

#Um valor a negrito (linha 1)
ftab_agreg_idade <- bold(ftab_agreg_idade,i=1,j=2,bold=TRUE, part="body")

#Um valor com destaque de cor
ftab_agreg_idade <- color(ftab_agreg_idade, i=2, j=2, color="violetred2", part="body")
ftab_agreg_idade
```
*Tabela 1 - Tabela com medidas descritivas sobre a idade dos inquiridos*

Podemos observar no grÃ¡fico 2 que a assimetria Ã© positiva, visto que a curva de densidade estÃ¡ a aumentar atÃ© ao valor da mÃ©dia. Assimetria positiva que corresponde ao valor da moda ser menor que o da mediana, e menor que o da mÃ©dia.(Moda â‰¤ Mediana < MÃ©dia)

```{r,echo=FALSE, fig.align='center'}
hist(bd$Idade,
     col =  cm.colors(7),
     freq = F,
     main = "Idades",
     xlab= "Idades",
     breaks = 6)
curve(dnorm(x, mean = mean(bd$Idade), sd=sd(bd$Idade)), add = T)
```
*GrÃ¡fico 2 - Histograma sobre a idade dos inquiridos*

AlÃ©m disso, a amostra Ã© constuÃ­da por 989 mulheres (62.8%) (Tabela 2) e o paÃ­s com mais representantes Ã© Portugal com 955 participantes (60.6%) (Tabela 3).

```{r, echo=FALSE, fig.align='center'}

# ---Sexo---

Sex_1<-table(bd$Sexo)
Sex_2<-round((prop.table(Sex_1)*100),1)

sexo_total<-table(bd$Sexo)
Percent<-round((prop.table(Sex_1)*100),1)

tab_Sex <- rbind(sexo_total,Percent)


Feminino_n <-as.numeric(Sex_1)[1]
Masculino_n <- as.numeric(Sex_1)[2]

Feminino_p <-as.numeric(Sex_2)[1]
Masculino_p <- as.numeric(Sex_2)[2]

Sexo_inquiridos <- c("Feminino", "Masculino")

n <- c(Feminino_n, Masculino_n)
Percentagem <- c(Feminino_p, Masculino_p)
table_objcompra <- data.frame(Sexo_inquiridos,n,Percentagem)
ftab_sexo <- flextable(head(table_objcompra))

ftab_sexo <- bg(ftab_sexo, bg = "#3895D3", part = "header")

ftab_sexo <- color(ftab_sexo, color = "white", part = "header")
ftab_sexo <- autofit(ftab_sexo) 
ftab_sexo
```
*Tabela 2 - Tabela de frequÃªncia sobre o sexo dos inquiridos*

```{r, echo=FALSE, fig.align='center'}

# ---PaÃ­s---

PaÃ­s_1<-table(bd$PaÃ­s_origem)
PaÃ­s_2<-round((prop.table(PaÃ­s_1)*100),1)

PaÃ­s_origem_total<-table(bd$PaÃ­s_origem)
Percent<-round((prop.table(PaÃ­s_1)*100),1)

tab_Sex <- rbind(PaÃ­s_origem_total,Percent)

Espanha_n <-as.numeric(PaÃ­s_1)[1]
Portugal_n <- as.numeric(PaÃ­s_1)[2]

Espanha_p <-as.numeric(PaÃ­s_2)[1]
Portugal_p <- as.numeric(PaÃ­s_2)[2]

PaÃ­s_origem_inquiridos <- c("Espanha", "Portugal")

n <- c(Espanha_n, Portugal_n)
Percentagem <- c(Espanha_p, Portugal_p)
table_objcompra <- data.frame(PaÃ­s_origem_inquiridos,n,Percentagem)
ftab_PaÃ­s_origem <- flextable(head(table_objcompra))

ftab_PaÃ­s_origem <- bg(ftab_PaÃ­s_origem, bg = "#3895D3", part = "header")

ftab_PaÃ­s_origem <- color(ftab_PaÃ­s_origem, color = "white", part = "header")
ftab_PaÃ­s_origem <- autofit(ftab_PaÃ­s_origem) 
ftab_PaÃ­s_origem
```
*Tabela 3 - Tabela de frequÃªncia sobre o paÃ­s de origem dos inquiridos*


O grÃ¡fico 3 demonstra que, tanto em Espanha, como em Portugal, existiram mais participantes do sexo feminino do que do sexo masculino.

```{r, echo=FALSE, fig.align='center'}
cc <- ggplot(bd, aes(x = PaÃ­s_origem)) +
  geom_bar(aes(fill = Sexo), colour = "black", position = "dodge", na.rm = TRUE)
cc + theme_test()
```
*GrÃ¡fico 3 -  GrÃ¡fico de barras com o sexo e o paÃ­s de origem dos inquiridos*


O agregado familiar Ã© uma variÃ¡vel atravÃ©s da qual se pode retirar informaÃ§Ã£o Ãºtil acerca dos inquiridos, podendo a mesma ser relacionada com outras variÃ¡veis do estudo, a fim de perceber se existe algum tipo de relaÃ§Ã£o entre as mesmas. 
Podemos visionar no grÃ¡fico 4 que existem 185 indivÃ­duos que vivem sozinhos, 434 individuos que vivem com 5 pessoas e poucos indivÃ­duos vivem com mais 3 pessoas.
Deste modo, conseguimos afirmar que existe um maior nÃºmero de inquiridos com um grande agregado familiar, o que irÃ¡ provocar um maior cuidado na hora do consumo, ou seja, possivelmente irÃ£o preferir produtos e marcas mais baratas, como tambÃ©m lojas localizadas mais perto.

```{r,echo=FALSE, fig.align='center'}
bd$Agregado_Familiar[bd$Agregado_Familiar==99] <- NA

tab_agregado <- table(bd$Agregado_Familiar)
barplot(tab_agregado,ylim=c(0,500),col= terrain.colors(14), main = "Agregado familiar")
```
*GrÃ¡fico 4 - GrÃ¡fico de barras com o agregado familiar*


Para termos uma melhor perspetiva acerca dos agregados criÃ¡mos a  tabela 4 com vÃ¡rios dados descritivos sobre o agregado dos inquiridos.
Ao analisarmos a tabela 4 percebemos que 75% dos jovens vivem com 9 ou menos pessoas. Em mÃ©dia, os jovens vivem com 6.6 pessoas, mas analisando o desvio padrÃ£o, podemos verificar que este nÃ£o Ã© muito pequeno, atigindo o valor de 3.2, demonstrando que esta mÃ©dia pode ser um pouco longe da realidade. Para reforÃ§ar esta ideia, temos o valor da variÃ¢ncia que Ã© muito elevado, demonstrando que os valores dos agregados estÃ£o muito dispersos da mÃ©dia.

```{r echo=FALSE, fig.align='center'}
bd$Agregado_Familiar[bd$Agregado_Familiar==99] <- NA

n <- length(bd$Agregado_Familiar)
media <- round(mean(bd$Agregado_Familiar,na.rm=TRUE),1)
moda <- 5
mediana <- median(bd$Agregado_Familiar,na.rm=TRUE)
desvpadr <- round(sd(bd$Agregado_Familiar, na.rm=TRUE),1)
varianc <- round(var(bd$Agregado_Familiar, na.rm=TRUE),1)
minimo <- min(bd$Agregado_Familiar, na.rm=TRUE)
maximo <- max(bd$Agregado_Familiar, na.rm=TRUE)
firstqt <- round(quantile(bd$Agregado_Familiar, 0.25, na.rm=TRUE),1)
thirdqt <- round(quantile(bd$Agregado_Familiar, 0.75, na.rm=TRUE), 1)
assimetria <- round(skewness(bd$Agregado_Familiar, na.rm=TRUE),1)
curtose <- round(kurtosis(bd$Agregado_Familiar, na.rm=TRUE),1)

# construÃ§Ã£o da tabela

Valor <- c(n, media, moda, mediana,  desvpadr, varianc, minimo, maximo, firstqt, thirdqt, assimetria, curtose)
Medidas <- c("N", "MÃ©dia","Moda","Mediana", "Desvio padrÃ£o", "VariÃ¢ncia", "MÃ­nimo", "MÃ¡ximo", "1ÂºQuartil", "3ÂºQuartil", "Assimetria", "Curtose")
table_agreg <- data.frame(Medidas,Valor)
ftab_agreg <- flextable(table_agreg)
ftab_agreg <- flextable(table_agreg)
ftab_agreg <- bg(ftab_agreg, bg = "#3895D3", part = "header")
ftab_agreg <- color(ftab_agreg, color = "white", part = "header")
ftab_agreg <- autofit(ftab_agreg)
ftab_agreg <- bold(ftab_agreg,i=1,bold=TRUE, part="body")
ftab_agreg <- color(ftab_agreg, i=2, j=2, color="violetred2", part="body")
ftab_agreg <- color(ftab_agreg, i=6:9, j=2, color="violetred2", part="body")
ftab_agreg
```
*Tabela 4 - Tabela de medidas descritivas sobre o agregado familiar*


De seguida, quisemos saber como era a dispersÃ£o dos agregados pela idade e, para isso, criÃ¡mos o grÃ¡fico 5 para testÃ¡-la. 
Observando o grÃ¡fico 5, chegamos Ã  conclusÃ£o que o nÃºmero de pessoas no agregado familiar dos jovens dos 18 aos 25 anos Ã© semelhante, tendo quase todos o valor 6 como mediana. Existe apenas uma pequena mudanÃ§a nos jovens com 20 anos onde o segundo quartil Ã© ligeiramente acima dos restantes e nÃ£o existe nenhum jovem de 25 anos com um agregado familiar de 14 elementos.

```{r, echo=FALSE, fig.align='center'}
boxplot(bd$Agregado_Familiar~bd$Idade, main = "Agregado Familiar",col = heat.colors(8), ylab="NÃºmero de pessoas pertencentes ao agregado", xlab="Idades")
```
*GrÃ¡fico 5 - Boxplot com a relaÃ§Ã£o entre idades e o nÃºmero de pessoas pertencentes ao agregado*


## Fidelidade a lojas

Seguidamente, colocÃ¡mos a pergunta: SerÃ¡ que a fidelidade a lojas nos jovens da amostra Ã© muito notÃ³ria? Fomos investigÃ¡-la construindo a tabela 5.
Ao analisarmos os dados da tabela 5 conseguimos notar que apenas 1515 jovens responderam a esta pergunta. A posiÃ§Ã£o e a identificaÃ§Ã£o dos 60 jovens que nÃ£o o fizeram encontra-se a seguir.

```{r, echo=FALSE, fig.align='center'}
bd$Fidelidade.a.lojas[bd$Fidelidade.a.lojas==99] <- NA

jmv::descriptives(
  data = bd,
  vars = Fidelidade.a.lojas,
  freq = TRUE,
  desc = "rows",
  missing = FALSE,
  mean = FALSE,
  median = FALSE,
  sd = FALSE,
  min = FALSE,
  max = FALSE)

```
*Tabela 5 - Tabela de frequÃªncia sobre a fidelidade a lojas*

```{r, echo=FALSE, fig.align='center'}
# Saber a posiÃ§Ã£o exata dos valores omissos (Que neste caso estÃ£o representados por 99)
bd$Fidelidade.a.lojas[which(is.na(bd$Fidelidade.a.lojas))] <- 99
which(bd$Fidelidade.a.lojas %in% 99)

# Transformar o 99 em NA para o R identificar como um valor omisso
bd$Fidelidade.a.lojas[bd$Fidelidade.a.lojas == 99] <- NA

# Existem 60 valores omissos
x <-  is.na(bd$Fidelidade.a.lojas)
Valores_omissos_fidel_lojas=(summary(x)[3])
Valores_omissos_fidel_lojas
```

De seguida, foi construÃ­do o grÃ¡fico 6 para possibilitar o estudo desta variÃ¡vel nos 2 paÃ­ses. Ao analisÃ¡-lo Ã© possivel verificar que os inquiridos espanhÃ³is tÃªm uma maior tendÃªncia para serem fiÃ©is Ã  loja onde compram do que os portugueses.

```{r, echo=FALSE, fig.align='center'}
bd$Fidelidade.a.lojas[bd$Fidelidade.a.lojas==99] <- NA
c1 <- na.omit(bd)

z <- ggplot(c1, aes(x = PaÃ­s_origem)) +
  geom_bar(aes(fill = Fidelidade.a.lojas), colour = "black", position = "dodge", na.rm = TRUE)
z + theme_test()
```
*GrÃ¡fico 6 - GrÃ¡fico de barras sobre a fidelidade a lojas em funÃ§Ã£o do paÃ­s*


Posteriormente, decidimos realizar o grÃ¡fico 7 que relaciona a fidelidade a lojas com o sexo.
Ao consultÃ¡-lo Ã© possivel verificar que o sexo feminino tem uma maior tendÃªncia para ser fiel Ã s lojas do que o sexo masculino.

```{r, echo=FALSE, fig.align='center'}
y <- ggplot(c1, aes(x = Sexo)) +
  geom_bar(aes(fill = Fidelidade.a.lojas), colour = "black", position = "dodge", na.rm = TRUE)
y + theme_test()
```
*GrÃ¡fico 7 - GrÃ¡fico de barras sobre a fidelidade a lojas em funÃ§Ã£o do sexo*


## ConveniÃªncia da localizaÃ§Ã£o da loja

Para a exploraÃ§Ã£o da variÃ¡vel "ConveniÃªncia da localizaÃ§Ã£o da loja" realizou-se o grÃ¡fico 8 com o objetivo de perceber se a nossa amostra considerava esta variÃ¡vel importante na hora da compra. Ao analisÃ¡-lo percebemos que 77,8% dos inquiridos julgam que a localizaÃ§Ã£o da mesma Ã© pouco importante ou importante, o que nos leva a crer que os jovens nÃ£o tÃªm este parÃ¢metro em grande consideraÃ§Ã£o na hora da compra.
Deste modo, podemos concluir que a localizaÃ§Ã£o da loja Ã© pouco relevante aquando da tomada de decisÃ£o da compra.

```{r,echo=FALSE, fig.align='center'}
bd$`ConveniÃªncia.da.localizaÃ§Ã£o.da.loja.-.codigo`[bd$`ConveniÃªncia.da.localizaÃ§Ã£o.da.loja.-.codigo`==99] <- NA

tab1 <- table(bd$`ConveniÃªncia.da.localizaÃ§Ã£o.da.loja.-.codigo`)
tab2 <- round(prop.table(tab1)*100,digits = 1)

nomes <- c("Nada importante","Pouco importante","Importante", "Muito importante", "Extremamente importante")
barplot(tab1,ylim=c(0,600),names.arg=nomes,col= usecol(c(Karpfenblau, Seeblau, "gold"), n = 7),cex.names=0.51)
text(0.7,50, tab2[1])
text(1.9,50, tab2[2])
text(3.1,50, tab2[3])
text(4.3,50, tab2[4])
text(5.5,20, tab2[5])

```
*GrÃ¡fico 8 - GrÃ¡fico de barras sobre a conveniÃªncia da localizaÃ§Ã£o da loja (com valores em percentagem)*


## PreÃ§o

Seguidamente colocÃ¡mos a seguinte tese: serÃ¡ que a nossa amostra de jovens considera o preÃ§o importante aquando do ato de tomada de decisÃ£o da compra. Primeiramente, fomos verificar os valores omissos da variÃ¡vel "PreÃ§o".
Nas cÃ©lulas com valores omissos procedeu-se Ã  imputaÃ§Ã£o de valores, utilizando a mediana do preÃ§o, pois sÃ£o apenas 8 valores, pelo que nÃ£o irÃ£o descaracterizar a amostra.

```{r, echo = FALSE}
bd$PreÃ§o[bd$PreÃ§o == 99] <- NA
# Existem 8 valores omissos
summary(is.na(bd$PreÃ§o))

# A mediana irÃ¡ ignorar os valores omissos
mediana <- median(bd$PreÃ§o,na.rm=TRUE)

# Substituir os valores omissos pela mediana
bd$PreÃ§o[which(is.na(bd$PreÃ§o))] <- mediana
summary(is.na(bd$PreÃ§o))
```

Ao analisarmos a tabela 6 vemos que a maioria da amostra situa-se na categoria "Importante"(42.2%) e que apenas 0.6% consideram o preÃ§o nada importante. 

```{r, echo = FALSE, fig.align='center'}
bd$PreÃ§o[bd$PreÃ§o==99] <- NA
Pr1<-table(bd$PreÃ§o)
Pr2<-round((prop.table(Pr1)*100),1)

PreÃ§o_<-table(bd$PreÃ§o)
Percentage<-round((prop.table(PreÃ§o_)*100),1)

tab_objcompra <- rbind(PreÃ§o_,Percentage)

## Tabela com o principal objetivo de compra com n e % (flextable)

Extremamente_importante_n <-as.numeric(Pr1)[1]
Importante_n <- as.numeric(Pr1)[2]
Muito_importante_n <- as.numeric(Pr1)[3]
Nada_importante_n <- as.numeric(Pr1)[4]
Pouco_importante_n <- as.numeric(Pr1)[5]

Extremamente_importante_p <-as.numeric(Pr2)[1]
Importante_p <- as.numeric(Pr2)[2]
Muito_importante_p <- as.numeric(Pr2)[3]
Nada_importante_p <- as.numeric(Pr2)[4]
Pouco_importante_p <- as.numeric(Pr2)[5]

PreÃ§o <- c("Nada importante","Pouco importante","Importante", "Muito importante", "Extremamente importante")

n <- c(Nada_importante_n,Pouco_importante_n,Importante_n,Muito_importante_n,Extremamente_importante_n)
Percentagem <- c(Nada_importante_p,Pouco_importante_p,Importante_p,Muito_importante_p,Extremamente_importante_p)
table_objcompra <- data.frame(PreÃ§o,n,Percentagem)
ftab_obj <- flextable(head(table_objcompra))

ftab_obj <- bg(ftab_obj, bg = "#3895D3", part = "header")

# definir a cor das letras no header definido a azul
ftab_obj <- color(ftab_obj, color = "white", part = "header")
ftab_obj <- autofit(ftab_obj) 
ftab_obj
```
*Tabela 6 - Tabela de frequÃªncia sobre o preÃ§o*


## A qualidade do produto 

Procedemos Ã  verificaÃ§Ã£o da seguinte hipÃ³tese: SerÃ¡ que a amostra de jovens dÃ¡ um peso significativo Ã  qualidade do produto quando vai comprÃ¡-lo? Para esse efeito construÃ­mos a tabela 7.
Ao observarmos a tabela 7 correspondente Ã  escala de Likert para as opiniÃµes dos jovens acerca da importÃ¢ncia da qualidade do produto, concluÃ­mos que, apenas 1.7% da amostra total a consideram nada ou pouco importante o que nos leva a concluir que a qualidade do produto Ã© realmente relevante aquando da compra do mesmo.

```{r echo=FALSE, fig.align='center'}
bd$Qualidade.do.produto[bd$Qualidade.do.produto==99] <- NA
Qual_produt_1<-table(bd$Qualidade.do.produto)
Qual_produt_2<-round((prop.table(Qual_produt_1)*100),1)

Qualidade_produto<-table(bd$Qualidade.do.produto)
Percent<-round((prop.table(Qual_produt_1)*100),1)

tab_objcompra <- rbind(Qualidade_produto,Percent)

## Tabela com o principal objetivo de compra com n e % (flextable)

Extremamente_importante_n <-as.numeric(Qual_produt_1)[1]
Importante_n <- as.numeric(Qual_produt_1)[2]
Muito_importante_n <- as.numeric(Qual_produt_1)[3]
Nada_importante_n <- as.numeric(Qual_produt_1)[4]
Pouco_importante_n <- as.numeric(Qual_produt_1)[5]

Extremamente_importante_p <-as.numeric(Qual_produt_2)[1]
Importante_p <- as.numeric(Qual_produt_2)[2]
Muito_importante_p <- as.numeric(Qual_produt_2)[3]
Nada_importante_p <- as.numeric(Qual_produt_2)[4]
Pouco_importante_p <- as.numeric(Qual_produt_2)[5]

Qualidade_do_produto <- c("Nada importante","Pouco importante","Importante", "Muito importante", "Extremamente importante")

n <- c(Nada_importante_n,Pouco_importante_n,Importante_n,Muito_importante_n,Extremamente_importante_n)
Percentagem <- c(Nada_importante_p,Pouco_importante_p,Importante_p,Muito_importante_p,Extremamente_importante_p)
table_objcompra <- data.frame(Qualidade_do_produto,n,Percentagem)
ftab_obj <- flextable(head(table_objcompra))

ftab_obj <- bg(ftab_obj, bg = "#3895D3", part = "header")

# definir a cor das letras no header definido a azul
ftab_obj <- color(ftab_obj, color = "white", part = "header")
ftab_obj <- autofit(ftab_obj) 
ftab_obj
```
*Tabela 7 - Tabela de frequÃªncia sobre a qualidade do produto*

De seguida, fomos verificar como o sexo e os paÃ­ses de origem se relacionavam com esta variÃ¡vel e, para tal, criÃ¡mos um boxplot (GrÃ¡fico 9). AtravÃ©s deste Ã© possÃ­vel verificar que os dois paÃ­ses de origem tÃªm pontos de vista um pouco diferentes, apesar de possuÃ­rem a mesma mediana (4 - â€œMuito Importanteâ€). Enquanto os inquiridos espanhÃ³is referem esta variÃ¡vel como estando principalmente entre as categorias 2 e 5, uma vez que poucos inquiridos deram 1 a esta variÃ¡vel; os inquiridos portugueses avaliaram substancialmente esta variÃ¡vel entre 3 e 5, sendo que existem poucos casos que a avaliaram com 2. Dando assim a entender que os portugueses consideram esta variÃ¡vel mais importante que os espanhÃ³is. Em relaÃ§Ã£o ao sexo, nÃ£o houve diferenÃ§as.
```{r, echo=FALSE, fig.align='center'}
bd$`Qualidade.do.produto.-.codigo`[bd$`Qualidade.do.produto.-.codigo`==99] <- NA

jmv::descriptives(
  formula = `Qualidade.do.produto.-.codigo` ~ Sexo:PaÃ­s_origem,
  data = bd,
  box = TRUE,
  n = FALSE,
  missing = FALSE,
  mean = FALSE,
  median = FALSE,
  sd = FALSE,
  min = FALSE,
  max = FALSE)
```
*GrÃ¡fico 9 - BoxPlot com a relaÃ§Ã£o entre o PaÃ­s de origem e o sexo com a qualidade do produto*

## A imagem do produto

RealizÃ¡mos o grÃ¡fico 10 para estudar a importÃ¢ncia da imagem do produto para os jovens inquiridos.

Podemos observar no grÃ¡fico 10 que para 46.2% dos inquiridos a imagem do produto Ã© importante e que para apenas 4.6% Ã© nada ou extremamente importante. Pelo que esta variÃ¡vel nÃ£o Ã© tÃ£o relevante quando comparada com a qualidade do produto.

```{r, echo=FALSE, fig.align='center'}
bd$Imagem.do.produto[bd$Imagem.do.produto==99] <- NA
bd_2 <- na.omit(bd)
# Percentagem de cada elemento
tab3 <- round(prop.table(table(bd$Imagem.do.produto))*100,digits=1)

pie(table(bd_2$Imagem.do.produto),
    main="Imagem do produto",
    labels = c("Extremamente importante (4.6%)","Importante (46.2%)"," Muito importante (20.4%)","Nada importante (4.6%)","Pouco importante (23.5%)"),
    #density = 55,
    #angle = 30,
    col = brewer.pal(6,"RdBu"),
    cex = 0.8)
```
*GrÃ¡fico 10 - GrÃ¡fico circular sobre a imagem do produto*


## A necessidade do produto

Por fim, fomos estudar a Ãºltima variÃ¡vel relacionada com a necessidade do produto para verificar se esta seria um fator a ter em conta ao comprar um produto.


Podemos observar que existe uma grande quantidade de respostas nos escalÃµes mais elevados, logo, Ã© possÃ­vel considerar que esta Ã© uma variÃ¡vel muito relevante. Podemos assim pressupor que, de forma geral, os jovens inquiridos sÃ£o facilmente influenciados pelo publicidade feita ao produto.

```{r, echo=FALSE, fig.align='center'}
bd$Necessidade.do.produto[bd$Necessidade.do.produto==99] <- NA

tab3 <- round(prop.table(table(bd$Necessidade.do.produto))*100,digits=1)

pie(table(bd$Necessidade.do.produto),
    main="Necessidade.do.produto",
    labels = c("Extremamente importante (30.6%)","Importante (24.1%)"," Muito importante (41.2%)","Nada importante (0.3%)","Pouco importante (3.8%)"),
    #density = 55,
    #angle = 30,
    col = brewer.pal(6,"Set2"),
    cex = 1)
```
*GrÃ¡fico 11 - GrÃ¡fico circular sobre a necessidade do produto*

CriÃ¡mos um boxplot com o objetivo de estudar o comportamento dos inquiridos, segundo o seu paÃ­s de origem e o sexo com a necessidade do produto. Visionando o grÃ¡fico 12 Ã© possÃ­vel verificar que, em relaÃ§Ã£o ao sexo, existem algumas diferenÃ§as. Apesar de ambos possuÃ­rem a mesma mediana, no sexo masculino a maioria avaliou esta variÃ¡vel com 4 e 5, alguns com 3, existindo ainda algumas exceÃ§Ãµes nos dois paÃ­ses e alguns homens portugueses a avaliar esta variÃ¡vel com 2; em Espanha ocorreu o mesmo e ainda houve respostas avaliadas com 1. Em relaÃ§Ã£o ao sexo feminino, existiu uma concordÃ¢ncia entre os dois paÃ­ses, havendo um maior nÃºmero de avaliaÃ§Ãµes entre 3 e 5 e  uma menor quantidade de respostas em 2. Para finalizar, em relaÃ§Ã£o ao paÃ­s, as avaliaÃ§Ãµes foram quase iguais, porÃ©m em Portugal ninguÃ©m avaliou com 1, como podemos ver nos outliers.
```{r, echo=FALSE, fig.align='center'}
bd$`Necessidade.do.produto.-.codigo`[bd$`Necessidade.do.produto.-.codigo`==99] <- NA
jmv::descriptives(
  formula = `Necessidade.do.produto.-.codigo` ~ Sexo:PaÃ­s_origem,
  data = bd,
  box = TRUE,
  n = FALSE,
  missing = FALSE,
  mean = FALSE,
  median = FALSE,
  sd = FALSE,
  min = FALSE,
  max = FALSE)
```
*GrÃ¡fico 12 - BoxPlot com a relaÃ§Ã£o entre o PaÃ­s de origem e o sexo com a necessidade do produto*

## ConclusÃ£o

Ao estudar as respostas do inquÃ©rito feito aos jovens portugueses e espanhÃ³is foi possÃ­vel aferir que a maioria dos jovens eram portugueses, do sexo feminino e rondavam os 21 anos.

AlÃ©m disso, foi possÃ­vel concluir que o agregado familiar nÃ£o tem muita influÃªncia nas respostas dadas, o que nÃ£o vai de encontro Ã s nossas expectativas, dado que pressupusemos que este fator fosse influenciar a importÃ¢ncia dada ao preÃ§o, quantidade e necessidade do produto aquando da compra.

Em relaÃ§Ã£o Ã  fidelidade a lojas, conseguimos perceber que os espanhÃ³is dÃ£o mais importÃ¢ncia a este fator do que os portugueses. TambÃ©m Ã© de salientar que o pÃºblico feminino tem este fator mais em conta que o masculino. 

Quanto Ã  conveniÃªncia da localizaÃ§Ã£o da loja e Ã  imagem do produto, pode-se aferir que nÃ£o sÃ£o muito relevantes na decisÃ£o de compra. JÃ¡ a qualidade, a necessidade e o preÃ§o do produto sÃ£o variÃ¡veis que se revelaram muito importantes, uma vez que a mÃ©dia e a mediana destas variÃ¡veis foram as mais altas.

Esta conclusÃ£o vai de encontro com as nossas expectativas, uma vez que antes de realizarmos este estudo tÃ­nhamos como pressuposto que o preÃ§o e a qualidade seriam as variÃ¡veis mais relevantes na hora da compra, no entanto, observÃ¡mos que a necessidade do produto tambÃ©m Ã© semelhantemente relevante. 

De seguida temos a seguinte tabela que ilustra o resultado obtido:

![](importancia.png)

*Tabela 8 - Tabela com as medidas descritivas de algumas variÃ¡veis*











